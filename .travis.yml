language: go
go:
  - 1.5.1
env:
  global:
    - TARGET_ARCH=amd64
    - CGO_ENABLED=1
  matrix:
    - TARGET_OS=linux
    - TARGET_OS=windows EXT=.exe CC=x86_64-w64-mingw32-gcc
addons:
  apt:
    packages:
    - binutils-mingw-w64-x86-64
    - gcc-mingw-w64-x86-64
before_script:
  - export GOARCH=$TARGET_ARCH GOOS=$TARGET_OS
before_deploy:
  - export GOARCH=$TARGET_ARCH GOOS=$TARGET_OS
deploy:
  provider: script
  script: $HOME/gopath/src/github.com/Lafeng/deblocus/static/deploy.sh
  on:
    branch: dev
